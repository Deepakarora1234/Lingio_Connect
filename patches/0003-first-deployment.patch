From 5665c0cd9c5b308a1c8def411bba146cec5b3285 Mon Sep 17 00:00:00 2001
From: Deepak Arora <arroadeepak0817@gmail.com>
Date: Sun, 28 Apr 2024 15:19:24 +0530
Subject: [PATCH 03/16] first deployment

---
 backend/firebase.js               | 18 ---------------
 backend/package.json              |  1 +
 backend/src/Routes/tutorRoutes.js |  6 +----
 backend/src/index.js              | 11 +++++++++
 frontend/package-lock.json        | 27 ++++++++++++++++++++++
 frontend/package.json             |  1 +
 frontend/src/apiClient.js         |  3 ++-
 frontend/src/pages/AddTutor.jsx   | 13 +++++++----
 frontend/src/pages/Home.jsx       | 37 -------------------------------
 9 files changed, 52 insertions(+), 65 deletions(-)
 delete mode 100644 backend/firebase.js

diff --git a/backend/firebase.js b/backend/firebase.js
deleted file mode 100644
index 6517e9c..0000000
--- a/backend/firebase.js
+++ /dev/null
@@ -1,18 +0,0 @@
-// Import the functions you need from the SDKs you need
-import { initializeApp } from "firebase/app";
-// TODO: Add SDKs for Firebase products that you want to use
-// https://firebase.google.com/docs/web/setup#available-libraries
-
-// Your web app's Firebase configuration
-const firebaseConfig = {
-  apiKey: "AIzaSyAJgyOGj-5wE5oJUve3an3JWLOFJeqOEqU",
-  authDomain: "lingio-connect.firebaseapp.com",
-  projectId: "lingio-connect",
-  storageBucket: "lingio-connect.appspot.com",
-  messagingSenderId: "1053916892280",
-  appId: "1:1053916892280:web:cc9f56fcb41f7522a1718d"
-};
-
-// Initialize Firebase
-const app = initializeApp(firebaseConfig);
-export default app
\ No newline at end of file
diff --git a/backend/package.json b/backend/package.json
index d6e4c46..461da0d 100644
--- a/backend/package.json
+++ b/backend/package.json
@@ -6,6 +6,7 @@
   "type": "module",
   "scripts": {
     "test": "",
+    "build":"npm install",
     "start": " nodemon src/index.js"
   },
   "author": "",
diff --git a/backend/src/Routes/tutorRoutes.js b/backend/src/Routes/tutorRoutes.js
index 7ccf841..d10c0a5 100644
--- a/backend/src/Routes/tutorRoutes.js
+++ b/backend/src/Routes/tutorRoutes.js
@@ -30,11 +30,7 @@ router.post("/",upload.single("imageFile"), async(req, res)=>{
         console.log(error)
         res.status(500).json("Something went wrong in adding tutor")
     }
-   
-
-
-
-
+  
 })
 export default router
 
diff --git a/backend/src/index.js b/backend/src/index.js
index efc602a..d98c8a9 100644
--- a/backend/src/index.js
+++ b/backend/src/index.js
@@ -6,6 +6,11 @@ import mongoose from "mongoose"
 import authRoutes from "../src/Routes/authRoutes.js"
 import tutorRoutes from "./Routes/tutorRoutes.js"
 import {v2 as cloudinary} from "cloudinary"
+import path from "path"
+
+
+const __dirname = path.resolve()
+
 
 cloudinary.config({
     cloud_name:"dm3jnihfu",
@@ -30,6 +35,12 @@ app.use(cors(
 app.use("/api/auth",authRoutes)
 app.use("/api/tutor", tutorRoutes)
 
+app.use(express.static(path.join(__dirname, "../../frontend/dist")))
+
+app.get("*", (req, res)=>{
+    res.sendFile(path.join(__dirname, "frontend", "dist", "index.html"))
+})
+
 
 
 app.listen('7000',()=>{
diff --git a/frontend/package-lock.json b/frontend/package-lock.json
index 8f09d55..d179a1f 100644
--- a/frontend/package-lock.json
+++ b/frontend/package-lock.json
@@ -15,6 +15,7 @@
         "@mui/styled-engine": "^5.15.14",
         "autoprefixer": "^10.4.19",
         "axios": "^1.6.8",
+        "cloudinary": "^2.2.0",
         "firebase": "^10.11.0",
         "framer-motion": "^11.0.28",
         "lottie-react": "^2.4.0",
@@ -2946,6 +2947,18 @@
         "url": "https://github.com/chalk/wrap-ansi?sponsor=1"
       }
     },
+    "node_modules/cloudinary": {
+      "version": "2.2.0",
+      "resolved": "https://registry.npmjs.org/cloudinary/-/cloudinary-2.2.0.tgz",
+      "integrity": "sha512-akbLTZcNegGSkl07Frnt9fyiK9KZ2zPS+a+j7uLrjNYxVhDpDdIBz9G6snPCYqgk+WLVMRPfXTObalLr5L6g0Q==",
+      "dependencies": {
+        "lodash": "^4.17.21",
+        "q": "^1.5.1"
+      },
+      "engines": {
+        "node": ">=9"
+      }
+    },
     "node_modules/clsx": {
       "version": "2.1.0",
       "resolved": "https://registry.npmjs.org/clsx/-/clsx-2.1.0.tgz",
@@ -4899,6 +4912,11 @@
         "url": "https://github.com/sponsors/sindresorhus"
       }
     },
+    "node_modules/lodash": {
+      "version": "4.17.21",
+      "resolved": "https://registry.npmjs.org/lodash/-/lodash-4.17.21.tgz",
+      "integrity": "sha512-v2kDEe57lecTulaDIuNTPy3Ry4gLGJ6Z1O3vE1krgXZNrsQ+LFTGHVxVjcXPs17LhbZVGedAJv8XZ1tvj5FvSg=="
+    },
     "node_modules/lodash.camelcase": {
       "version": "4.3.0",
       "resolved": "https://registry.npmjs.org/lodash.camelcase/-/lodash.camelcase-4.3.0.tgz",
@@ -5637,6 +5655,15 @@
         "node": ">=6"
       }
     },
+    "node_modules/q": {
+      "version": "1.5.1",
+      "resolved": "https://registry.npmjs.org/q/-/q-1.5.1.tgz",
+      "integrity": "sha512-kV/CThkXo6xyFEZUugw/+pIOywXcDbFYgSct5cT3gqlbkBE1SJdwy6UQoZvodiWF/ckQLZyDE/Bu1M6gVu5lVw==",
+      "engines": {
+        "node": ">=0.6.0",
+        "teleport": ">=0.2.0"
+      }
+    },
     "node_modules/queue-microtask": {
       "version": "1.2.3",
       "resolved": "https://registry.npmjs.org/queue-microtask/-/queue-microtask-1.2.3.tgz",
diff --git a/frontend/package.json b/frontend/package.json
index 5bd2c60..4876d46 100644
--- a/frontend/package.json
+++ b/frontend/package.json
@@ -17,6 +17,7 @@
     "@mui/styled-engine": "^5.15.14",
     "autoprefixer": "^10.4.19",
     "axios": "^1.6.8",
+    "cloudinary": "^2.2.0",
     "firebase": "^10.11.0",
     "framer-motion": "^11.0.28",
     "lottie-react": "^2.4.0",
diff --git a/frontend/src/apiClient.js b/frontend/src/apiClient.js
index 19e3240..22ce439 100644
--- a/frontend/src/apiClient.js
+++ b/frontend/src/apiClient.js
@@ -18,7 +18,7 @@ export const auth = async (user) => {
   };
 
   export const addTutor = async(data)=>{
-    console.log(data)
+   
     const response = await fetch(`/api/tutor`, {
       method:"POST",
       credentials:"include",
@@ -26,6 +26,7 @@ export const auth = async (user) => {
         "Content-Type":"application/json"
       },
       body:JSON.stringify(data)
+      
 
     })
     const responseBody = await response.json()
diff --git a/frontend/src/pages/AddTutor.jsx b/frontend/src/pages/AddTutor.jsx
index 56e03b5..7947c89 100644
--- a/frontend/src/pages/AddTutor.jsx
+++ b/frontend/src/pages/AddTutor.jsx
@@ -11,7 +11,9 @@ import {useMutation} from "react-query"
 import * as apiClient from "../apiClient.js"
 
 
+
 const AddTutor = () => {
+   
     const formMethods = useForm();
     const {register, handleSubmit, formState: {errors}}  = formMethods
     const mutation = useMutation(apiClient.addTutor,{
@@ -24,7 +26,9 @@ const AddTutor = () => {
     })
     const onSubmit = handleSubmit(async (data) => {
         const file = data.image[0]; 
-        // console.log('File:', file);
+      
+
+        console.log('File:', file);
         if (file) {
             const fileName = new Date().getTime() + '_' + file.name;
             const storage = getStorage(app);
@@ -72,6 +76,7 @@ const AddTutor = () => {
                 return;
             }
         }
+        
         mutation.mutate(data);
     });
     
@@ -130,9 +135,9 @@ const AddTutor = () => {
                 <label className='bg-black p-2 text-xl  text-white  '>
                     Upload profile picture
                 </label>
-            <input className='bg-black p-2 text-sm border-2 text-white  rounded-lg border-cyan-950'  type='file' multiple accept="image/*"  name='image' {...register('image', {required : "Choose an image"})} />
-            {errors.imageFile && (
-                <span className='text-red-700 text-sm'>{errors.imageFile.message}</span>
+            <input className='bg-black p-2 text-sm border-2 text-white  rounded-lg border-cyan-950'  type='file'   name='image' {...register('image')} />
+            {errors.image && (
+                <span className='text-red-700 text-sm'>{errors.image.message}</span>
             )}
             </div>
             <button className='hover:bg-black mt-4 bg-cyan-950 text-white font-bold text-xl p-3 border rounded-lg ' >Add Tutor</button>
diff --git a/frontend/src/pages/Home.jsx b/frontend/src/pages/Home.jsx
index 23578da..7d8968e 100644
--- a/frontend/src/pages/Home.jsx
+++ b/frontend/src/pages/Home.jsx
@@ -1,39 +1,3 @@
-// import React, { useEffect } from 'react';
-// import Header from '../components/Header';
-// import { useAuth0 } from "@auth0/auth0-react";
-// import axios from "axios";
-// import { useMutation } from 'react-query';
-// import * as apiClient from "../apiClient.js"
-
-// const Home = () => {
-//     const { user, isAuthenticated } = useAuth0();
-
-//     useEffect(() => {
-//         const fetchData = async () => {
-//             if (isAuthenticated) {
-//                 try {
-//                     const { data } = await axios.post("http://localhost:7000/api/auth", {
-//                         auth0Id:user.sub,email:user.email
-//                     });
-                   
-//                 } catch (error) {
-//                     console.error("Error:", error);
-//                 }
-//             }
-//         };
-
-//         fetchData();
-//     }, [isAuthenticated, user]);
-
-//     return (
-//         <div>
-//             <Header />
-//         </div>
-//     );
-// };
-
-// export default Home;
-
 import React, { useEffect } from 'react';
 import Header from '../components/Header';
 import { useAuth0 } from "@auth0/auth0-react";
@@ -64,7 +28,6 @@ const Home = () => {
     return (
         <div>
             <Header />
-            {/* <img src="https://lh3.googleusercontent.com/a/ACg8ocJOOSbxS2C_38Hg_vfnMZ6fuofK8S0dIfA_XkQHoDcmSKue17me=s96-c" alt="User profile picture"></img> */}
         </div>
     );
 };
-- 
2.41.0.windows.3

